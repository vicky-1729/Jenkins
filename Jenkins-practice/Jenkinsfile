pipeline {
    agent {
        label "roboshop-agent"  // Which Jenkins agent to use
    }
    
    options {
        timeout(time: 30, unit: 'MINUTES')  // Time out after 30 minutes
        disableConcurrentBuilds()           // Don't run multiple builds at once
        timestamps()                        // Add timestamps to console output
    }
    
    environment {
        COURSE = "Jenkins"                  // Example environment variable
        VERSION = "1.0.${BUILD_NUMBER}"     // Simple version using build number
    }
    
    stages {
        stage('Build') {
            steps {
                echo "Building version: ${VERSION}"
                // sh 'npm install'
                // sh 'npm run build'
            }
        }
        
        stage('Test') {
            steps {
                echo "Running tests..."
                echo "Course name is: ${env.COURSE}"
                // sh 'npm test'
            }
        }
        
        stage('Deploy') {
            steps {
                echo "Deploying application..."
                // sh 'deploy-script.sh'
            }
        }
        
        stage('Approval') {
            steps {
                input(
                    message: "Continue to next step?",
                    ok: "Approve"
                )
            }
        }
    }
    
    post {
        always {
            echo "Pipeline finished - cleanup if needed"
        }
        
        success {
            echo "Build successful!"
        }
        
        failure {
            echo "Build failed. Check logs for details."
        }
    }
}
